<?xml version="1.0" encoding="utf-8" ?>
<mct:Popup xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
           xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
           xmlns:mct="clr-namespace:CommunityToolkit.Maui.Views;assembly=CommunityToolkit.Maui"
           xmlns:loc="clr-namespace:Foodbook.Services"
           xmlns:components="clr-namespace:Foodbook.Views.Components"
           x:Class="Foodbook.Views.Components.SearchablePickerPopup"
           x:Name="ThisPopup"
           x:DataType="components:SearchablePickerPopup"
           CanBeDismissedByTappingOutsideOfPopup="True"
           Padding="0"
           Margin="0">

    <Border BackgroundColor="{DynamicResource PageBackgroundColor}"
            StrokeShape="RoundRectangle 12"
            StrokeThickness="1"
            Stroke="{DynamicResource Secondary}"
            MinimumWidthRequest="300"
            MaximumWidthRequest="500"
            MinimumHeightRequest="320"
            MaximumHeightRequest="600">
        <Grid RowDefinitions="Auto,*" Padding="0">
            <!-- Header (search bar + close button) -->
            <StackLayout Grid.Row="0"
                         BackgroundColor="{DynamicResource ShellBackgroundColor}"
                         Padding="12,10">
                <Grid ColumnDefinitions="*,Auto" Padding="6,6">
                    <!-- Modern search bar component -->
                    <components:ModernSearchBarComponent Grid.Column="0"
                                                         SearchText="{Binding SearchText, Source={x:Reference ThisPopup}}"
                                                         PlaceholderText="Szukaj..."
                                                         ClearCommand="{Binding ClearSearchCommand, Source={x:Reference ThisPopup}}" />

                    <!-- Close button -->
                    <Button Grid.Column="1"
                            Text="X"
                            FontSize="16"
                            WidthRequest="32"
                            HeightRequest="32"
                            CornerRadius="16"
                            BackgroundColor="Transparent"
                            TextColor="{DynamicResource ShellTitleColor}"
                            Command="{Binding CloseCommand, Source={x:Reference ThisPopup}}" />
                </Grid>
            </StackLayout>

            <!-- List -->
            <ScrollView Grid.Row="1" Padding="8,4">
                <StackLayout x:Name="ItemsHost" Spacing="6" />
            </ScrollView>
        </Grid>
    </Border>
</mct:Popup>