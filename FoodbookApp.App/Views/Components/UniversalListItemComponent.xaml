<?xml version="1.0" encoding="utf-8" ?>
<ContentView xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:converters="clr-namespace:Foodbook.Converters"
             x:Class="Foodbook.Views.Components.UniversalListItemComponent"
             x:Name="ItemComponent">

    <ContentView.Resources>
        <ResourceDictionary>
            <converters:ItemTitleConverter x:Key="ItemTitleConverter" />
        </ResourceDictionary>
    </ContentView.Resources>

    <ContentView.GestureRecognizers>
        <TapGestureRecognizer Command="{Binding EditCommand, Source={x:Reference ItemComponent}}"
                              CommandParameter="{Binding .}" />
    </ContentView.GestureRecognizers>

    <ContentView Style="{StaticResource ListItemContainer}">
        <Frame Style="{StaticResource ListItemFrame}" Padding="0">
            <Frame.GestureRecognizers>
                <TapGestureRecognizer Command="{Binding EditCommand, Source={x:Reference ItemComponent}}"
                                      CommandParameter="{Binding .}" />
            </Frame.GestureRecognizers>

            <Grid Margin="12" ColumnDefinitions="*,Auto">
                <VerticalStackLayout Grid.Column="0" Spacing="2">
                    <!-- Title: fixed label for plan mode, otherwise use Name -->
                    <Label Style="{StaticResource ItemTitleLabel}">
                        <Label.Triggers>
                            <DataTrigger TargetType="Label"
                                         Binding="{Binding ShowPlanLayout, Source={x:Reference ItemComponent}}"
                                         Value="True">
                                <Setter Property="Text" Value="Lista zakupów" />
                            </DataTrigger>
                        </Label.Triggers>
                        <Label.Text>
                            <Binding Path="Name" />
                        </Label.Text>
                    </Label>

                    <!-- Bottom date range in Primary color for plan mode -->
                    <Label FontSize="12"
                           TextColor="{DynamicResource Primary}"
                           IsVisible="{Binding ShowPlanLayout, Source={x:Reference ItemComponent}}">
                        <Label.Text>
                            <MultiBinding StringFormat="{}{0:d} – {1:d}">
                                <Binding Path="StartDate" />
                                <Binding Path="EndDate" />
                            </MultiBinding>
                        </Label.Text>
                    </Label>
                </VerticalStackLayout>

                <HorizontalStackLayout Grid.Column="1" Spacing="6" VerticalOptions="Center">
                    <!-- Archive (for plans) uses image from Resources/Images/save -->
                    <ImageButton Style="{StaticResource ListActionImageButton}"
                                 Source="save"
                                 IsVisible="{Binding ShowArchiveButton, Source={x:Reference ItemComponent}}"
                                 Command="{Binding ArchiveCommand, Source={x:Reference ItemComponent}}"
                                 CommandParameter="{Binding .}" />
                </HorizontalStackLayout>
            </Grid>
        </Frame>
    </ContentView>

</ContentView>