<?xml version="1.0" encoding="utf-8" ?>
<ContentView xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="Foodbook.Views.Components.UniversalListItemComponent"
             x:Name="ItemComponent">

    <ContentView Style="{StaticResource ListItemContainer}">
        <Frame Style="{StaticResource ListItemFrame}">
            <Frame.GestureRecognizers>
                <TapGestureRecognizer Command="{Binding EditCommand, Source={x:Reference ItemComponent}}" 
                                      CommandParameter="{Binding .}" />
            </Frame.GestureRecognizers>
            <Grid Style="{StaticResource ListItemContentGrid}" ColumnDefinitions="*,Auto">
                <!-- Item content column -->
                <StackLayout Grid.Column="0" Spacing="2">
                    <Label Text="{Binding Name}" Style="{StaticResource ItemTitleLabel}" />
                    
                    <!-- Subtitle (quantity and unit) - only visible for ingredients -->
                    <Label Style="{StaticResource ItemSubtitleLabel}"
                           IsVisible="{Binding ShowSubtitle, Source={x:Reference ItemComponent}}">
                        <Label.Text>
                            <MultiBinding StringFormat="{}{0:F1} {1}">
                                <Binding Path="Quantity" />
                                <Binding Path="Unit" />
                            </MultiBinding>
                        </Label.Text>
                    </Label>
                    
                    <!-- Nutrition info in horizontal layout -->
                    <StackLayout Style="{StaticResource NutritionContainer}">
                        <Label Style="{StaticResource CaloriesLabel}">
                            <Label.Text>
                                <MultiBinding StringFormat="{}{0:F0} kcal">
                                    <Binding Path="Calories" />
                                </MultiBinding>
                            </Label.Text>
                        </Label>
                        <Label Style="{StaticResource MacroLabel}">
                            <Label.Text>
                                <MultiBinding StringFormat="P: {0:F1}g">
                                    <Binding Path="Protein" />
                                </MultiBinding>
                            </Label.Text>
                        </Label>
                        <Label Style="{StaticResource MacroLabel}">
                            <Label.Text>
                                <MultiBinding StringFormat="F: {0:F1}g">
                                    <Binding Path="Fat" />
                                </MultiBinding>
                            </Label.Text>
                        </Label>
                        <Label Style="{StaticResource MacroLabel}">
                            <Label.Text>
                                <MultiBinding StringFormat="C: {0:F1}g">
                                    <Binding Path="Carbs" />
                                </MultiBinding>
                            </Label.Text>
                        </Label>
                    </StackLayout>
                </StackLayout>
                
                <!-- Delete button -->
                <Button Grid.Column="1" 
                        Style="{StaticResource DeleteButton}"
                        Command="{Binding DeleteCommand, Source={x:Reference ItemComponent}}" 
                        CommandParameter="{Binding .}" />
            </Grid>
        </Frame>
    </ContentView>

</ContentView>